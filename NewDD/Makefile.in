#--------------------------------------------------
#--- Makefile for NewDD
#--- Generated by ../configure
#--------------------------------------------------

#--------------------------------------------------
# Compiler settings (configured by ../configure)
#--------------------------------------------------
CC = @CC@
OPT = @OPT@ -DNENER=@NENER@ -DNPRE=@NPRE@ -DNMEG=@NEWDD_NMEG@ -DWGROUPSIZE=@NEWDD_WGROUPSIZE@  -DUSE_MPI -DQUADHILBERT -DREAD_SINK -DNCHEM=@NEWDD_NCHEM@ -DNDUST=@NEWDD_NDUST@ -DDEBUG=1 -DLOG=1

RANLIB = ranlib

CFLAGS = $(OPT)
CCLAGS = $(OPT)

LIBS       = libmyram.a

TIMEROBJ       = rd_amr.o  rd_info.o  rd_part.o header.o utils.o Memory2.o find_leaf_gas.o rd_hydro.o rd_sink.o

NEWDD	= newdd.exe
NEWDDOBJ	= newdd.o

INCLUDES = -I./ -I../

default:
	$(MAKE) $(LIBS)
	$(RANLIB) $(LIBS)

all:
	$(MAKE) $(LIBS)
	$(MAKE) $(NEWDDOBJ)
	$(MAKE) $(NEWDD)

new:
	$(MAKE) clean
	$(MAKE) $(LIBS)

newdd:
	-rm -f newdd.exe
	$(MAKE) $(NEWDDOBJ)
	$(MAKE) $(NEWDD)

$(LIBS): $(TIMEROBJ)
	ar -rcv $@ $?
	ranlib $@

OSTLIB = -L. -lmyram  -L@FFTW_PATH@/lib -lm

%.c:
	$(CC) $(CFLAGS) -c $*.c

clean:
	-rm -f *.o *.a *.d core  *.exe

#--- Suffix-based compilation rules
.SUFFIXES: .exe .o .c

#rules to build binary from source

.c.o :
	$(CC) $(CFLAGS) $(INCLUDES) -c $<

.c.exe :
	$(CC) $(CFLAGS) $(LDFLAGS) $(INCLUDES) -o $*.exe $(NEWDDOBJ) $(OSTLIB)
